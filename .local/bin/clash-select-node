#!/usr/bin/dash

if ! clash-api >/dev/null 2>&1; then
  echo "Clash is not started yet!"
  exit 1
fi

node="ðŸ”° é€‰æ‹©èŠ‚ç‚¹"

if ! selected="$(clash-api "proxies/$node" | fj -r0 '.all[*]' | \
      fzf --read0 --print0 | xargs -0 -I S printf '%sx' S)"; then
  exit 1
fi

clash-api -S "${selected%x}" "proxies/$node"
